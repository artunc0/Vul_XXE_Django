
<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Vulnerable Search Page</title>
  <link rel="stylesheet" type = "text/css" href="../static/style.css">

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script type="text/javascript">

async function XMLFunction(){
	var xml = '' +
	'<?xml version="1.0" encoding="UTF-8"?>' +
	'<!DOCTYPE root [<!ENTITY myentity "my entity value" >]>' +
	'<root>' +
	'<search_param>' + $('#search').val() + '</search_param>' +
	'</root>';
	var xmlhttp = new XMLHttpRequest();
	xmlhttp.onreadystatechange = function () {
        if(xmlhttp.readyState == 4){
            console.log(xmlhttp.readyState);
            console.log(xmlhttp.responseText);
            document.getElementById('errorMessage').innerHTML = xmlhttp.responseText;
        }
    }
    xmlhttp.open("POST", 'search', true);
    var response = await xmlhttp.send(xml);
	document.getElementById("results").innerHTML = response
};

function HintFunction(){

document.getElementById("hint").innerHTML = "FLAG EXISTS ";
}

</script>

</head>
<body>

<div id="bg"></div>

<form>
  <div class="form-field">
    <input type="search" id="search" type="text" class="text" value="" placeholder="Search anything..."  required/>
  </div>

  <div class="form-field">
    <button class="btn" type="submit" onclick="XMLFunction()">Search!</button>
  </div>

  <br><br>
  <div style="text-align:center;">
  <button  id = "hintbutton" onclick="HintFunction()"> Hint </button> 
    <p id="hint"></p>
  </div>

  <div id="errorMessage">
  </div>
  <br><br>

</form>
<h3>Results:</h3>
<br>
<br>
<br>
	<p id="results"></p>
  
</body>
</html>
